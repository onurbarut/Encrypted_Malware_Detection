# Encrypted_Malware_Detection
This is the implementation of the paper ["Machine Learning Based Malware Detection on Encrypted Traffic: A Comprehensive Performance Study" (NSysS), 2020](https://dl.acm.org/doi/abs/10.1145/3428363.3428365)

## Dataset

The dataset splits are NetML and CICIDS2017 which are curated from [NetML Competition 2020](https://github.com/ACANETS/NetML-Competition2020)

## Requirements

- python 3.5.8 or higher
- matplotlib
- tensorflow-gpu 1.6.0 or higher
- pandas
- psutil
- memory-profiler

## Create and setup the virtual Environment

```shell
python3 -m venv ./env
```

```shell
source ./env/bin/activate
```

```shell
pip install -r requirements.txt
```

## Exporting Top-50 features with Chi^2:

Modify line 19 and line 20 of nsyss_export2csv.py for dataset and annotation. Make use the datasets are downloaded from [NetML Competition 2020 repository](https://github.com/ACANETS/NetML-Competition2020)

```shell
python3 nsyss_export2csv.py
```

## Training and Testing

When the virtual environment is activated:

```shell
python3 nsyss_benchmarkCPU.py 
```

or

```shell
python3 nsyss_benchmarkGPU.py 
```

Change lines 301 and 303 for model and dataset.

### DAAL

For experiments with DAAL (Intel Data Analytics Acceleration Library), make sure to install pyDAAL first.

```shell
python3 nsyss_benchmarkDAAL.py 
```

### OpenVino

For experiments with OpenVino, make sure to install it first. Then, use vino_nsyss2020 folder.

```shell
cd vino_nsyss2020
python3 nsyss_benchmarkVino.py 
```
## References

If this repository was useful for your research, please cite.

```
@inproceedings{10.1145/3428363.3428365,
author = {Barut, Onur and Grohotolski, Matthew and DiLeo, Connor and Luo, Yan and Li, Peilong and Zhang, Tong},
title = {Machine Learning Based Malware Detection on Encrypted Traffic: A Comprehensive Performance Study},
year = {2020},
isbn = {9781450389051},
publisher = {Association for Computing Machinery},
address = {New York, NY, USA},
url = {https://doi.org/10.1145/3428363.3428365},
doi = {10.1145/3428363.3428365},
abstract = { The increasing volume of encrypted network traffic yields a clutter for hackers to use encryption to spread their malicious software on the network. We study the problem of detecting TLS-encrypted malware on the client side using metadata and TLS protocol related flow features. We conduct a comprehensive study on a set of widely used machine learning and deep learning algorithms to detect encrypted malware on two malware flows datasets. In addition to reporting the classification accuracy of the approaches under study, we conduct comprehensive experiments to quantify their run-time performance in terms of throughput and system resource utilization such as the CPU and RAM utilization. Moreover, we further boost the speed of the detection systems using acceleration libraries such as DAAL and OpenVINO. Through the quantitative analysis, we provide a comparison on the effectiveness and run-time performance of the machine learning models, and evaluate techniques to accelerate real-world deployment.},
booktitle = {7th International Conference on Networking, Systems and Security},
pages = {45â€“55},
numpages = {11},
keywords = {malware detection, encrypted traffic analysis, machine learning, deep learning},
location = {Dhaka, Bangladesh},
series = {7th NSysS 2020}
}
```